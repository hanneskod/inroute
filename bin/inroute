#!/usr/bin/env php
<?php
/*
 * This file is part of the inroute package
 *
 * Copyright (c) 2013 Hannes ForsgÃ¥rd
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace iio\inroute;

use Symfony\Component\Console\Application;

$loaderPaths = array(
    'autoload.php',
    'vendor/autoload.php',
    '../vendor/autoload.php',
    '../../vendor/autoload.php',
    '../../../vendor/autoload.php',
);

foreach ($loaderPaths as $filename) {
    if (file_exists($filename)) {
        $loader = include $filename;
    }
}

if (!isset($loader)) {
    foreach ($argv as $arg) {
        if (preg_match('/--loader=([^\s]+)/', $arg, $match)) {
            $loader = $match[1];
        }
    }
}

if (!isset($loader)) {
    echo "Unable to find composer autoloader, use --loader=path/to/autoload.php to specify\n";
    die();
}

$app = new Application('inroute', 'dev');
$app->add(new Console\BuildCommand($loader));
$app->run();
